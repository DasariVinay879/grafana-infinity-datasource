1:HL["/grafana-infinity-datasource/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/grafana-infinity-datasource/_next/static/css/c6729501c94bc17c.css",{"as":"style"}]
0:["lD4gonJRCvN0m-pJqE7OI",[[["",{"children":["blog",{"children":[["slug","01-thingspeak","c"],{"children":["__PAGE__?{\"slug\":[\"01-thingspeak\"]}",{}]}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/grafana-infinity-datasource/_next/static/css/c6729501c94bc17c.css","precedence":"next"}]],"$L4"]]]]
5:I{"id":3189,"chunks":["310:static/chunks/0e5ce63c-ef4c11e95cfe58be.js","222:static/chunks/222-61f75ea56c49879c.js","413:static/chunks/413-95877600faafadc3.js","685:static/chunks/685-b14093ee69651263.js","394:static/chunks/394-9ae0597d4a2d05bc.js","185:static/chunks/app/layout-6a90743b40cdcb3e.js"],"name":"","async":false}
6:I{"id":7767,"chunks":["272:static/chunks/webpack-acc533850910ac6f.js","971:static/chunks/fd9d1056-7fa96bc4412ca339.js","596:static/chunks/596-582349f5b7d1459d.js"],"name":"default","async":false}
7:I{"id":7920,"chunks":["272:static/chunks/webpack-acc533850910ac6f.js","971:static/chunks/fd9d1056-7fa96bc4412ca339.js","596:static/chunks/596-582349f5b7d1459d.js"],"name":"default","async":false}
3:[null,["$","$L5",null,{"children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":["$","div",null,{"className":"text-center m-auto ml-[30%] my-[25%]","children":"Sorry..! Page not found."}],"notFoundStyles":[],"childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children",["slug","01-thingspeak","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L8","$L9",null],"segment":"__PAGE__?{\"slug\":[\"01-thingspeak\"]}"},"styles":[]}],"segment":["slug","01-thingspeak","c"]},"styles":[]}],"segment":"blog"},"styles":[]}],"params":{}}],null]
4:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Thingspeak API"}],["$","meta","2",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","3",{"rel":"icon","href":"/grafana-infinity-datasource/favicon.ico","type":"image/x-icon","sizes":"32x32"}],["$","meta","4",{"name":"next-size-adjust"}]]
a:I{"id":4785,"chunks":["222:static/chunks/222-61f75ea56c49879c.js","413:static/chunks/413-95877600faafadc3.js","797:static/chunks/app/blog/[...slug]/page-2b49f2ea15456e19.js"],"name":"Mdx","async":false}
b:T1cf1,var Component=(()=>{var d=Object.create;var s=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var f=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),y=(a,e)=>{for(var t in e)s(a,t,{get:e[t],enumerable:!0})},r=(a,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of g(e))!p.call(a,i)&&i!==t&&s(a,i,{get:()=>e[i],enumerable:!(o=m(e,i))||o.enumerable});return a};var b=(a,e,t)=>(t=a!=null?d(u(a)):{},r(e||!a||!a.__esModule?s(t,"default",{value:a,enumerable:!0}):t,a)),N=a=>r(s({},"__esModule",{value:!0}),a);var l=f((_,c)=>{c.exports=_jsx_runtime});var x={};y(x,{default:()=>Y,frontmatter:()=>k});var n=b(l()),k={slug:"/blog/thingspeak",title:"Thingspeak API",date:"2022-01-28",tags:["blog","iot","tutorial","example","thingspeak","json","csv","xml"]};function h(a){let e=Object.assign({p:"p",a:"a",h2:"h2",span:"span",code:"code",img:"img",strong:"strong",blockquote:"blockquote"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:"In this example, we are going to visualize data from ThingSpeak API."}),`
`,(0,n.jsxs)(e.p,{children:["For demo purpose, I am using ",(0,n.jsx)(e.a,{href:"https://thingspeak.com/channels/38629",children:"traffic monitor public channel"})," ( Channel ID : 38629 ). You may know already that, ThingSpeak APIs available in different formats such as JSON, CSV and XML. We are going to see how to use all of those different API formats."]}),`
`,(0,n.jsxs)(e.h2,{id:"json-example",children:[(0,n.jsx)(e.a,{className:"anchor",href:"#json-example",children:(0,n.jsx)(e.span,{className:"icon icon-link"})}),"JSON Example"]}),`
`,(0,n.jsxs)(e.p,{children:["As you can see in the below picture, I am using the ",(0,n.jsx)(e.a,{href:"https://thingspeak.com/channels/38629/feed.json",children:"JSON feed url"})," of the channel. If you look at the JSON schema, my data points are under the node called ",(0,n.jsx)(e.code,{children:"feeds"}),". So I specify the same as my ",(0,n.jsx)(e.code,{children:"Rows/Root"})," selector. Then for the columns, we need to first specify our time column which is ",(0,n.jsx)(e.code,{children:"created_at"})," field in our json feed. Then we can specify one or more metrics(number) fields as shown in the below picture."]}),`
`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:"https://user-images.githubusercontent.com/153843/108479371-9030bb00-728d-11eb-8ae5-f186c78db64e.png#center",alt:"image"})}),`
`,(0,n.jsxs)(e.h2,{id:"csv-example",children:[(0,n.jsx)(e.a,{className:"anchor",href:"#csv-example",children:(0,n.jsx)(e.span,{className:"icon icon-link"})}),"CSV Example"]}),`
`,(0,n.jsxs)(e.p,{children:["If you prefer CSV format over JSON, here is the example settings of the same channel. I am using ",(0,n.jsx)(e.a,{href:"https://thingspeak.com/channels/38629/feed.csv",children:"CSV feed url"})," of the channel. In the query, Choose ",(0,n.jsx)(e.code,{children:"CSV"})," as your type, specify the csv feed URL and then the fields you needed along with time field."]}),`
`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:"https://user-images.githubusercontent.com/153843/108479976-4b595400-728e-11eb-868e-b2d550f496f3.png#center",alt:"image"})}),`
`,(0,n.jsxs)(e.h2,{id:"xml-example",children:[(0,n.jsx)(e.a,{className:"anchor",href:"#xml-example",children:(0,n.jsx)(e.span,{className:"icon icon-link"})}),"XML Example"]}),`
`,(0,n.jsxs)(e.p,{children:["You are not limited to CSV, JSON. You can also use xml format as well in your query if your prefer that. I am using ",(0,n.jsx)(e.a,{href:"https://thingspeak.com/channels/38629/feed.xml",children:"XML feed url"})," of the channel. Query setup is almost same as csv/json. Notable configurations are your rows/root field and timestamp field. As you see in the below picture, I am using ",(0,n.jsx)(e.code,{children:"channel.feeds[0].feed"})," as my root/rows selector and then for selecting timestamp, I use ",(0,n.jsx)(e.code,{children:"created-at[0]._"})]}),`
`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:"https://user-images.githubusercontent.com/153843/108480329-b99e1680-728e-11eb-91f3-38c5585477e2.png#center",alt:"image"})}),`
`,(0,n.jsxs)(e.h2,{id:"using-grafanas-time-filter",children:[(0,n.jsx)(e.a,{className:"anchor",href:"#using-grafanas-time-filter",children:(0,n.jsx)(e.span,{className:"icon icon-link"})}),"Using Grafana's time filter"]}),`
`,(0,n.jsxs)(e.p,{children:["Once you setup the query, you may find that your are always querying recent data in the graphs irrespective of the time range chosen in Grafana. To solve this issue, we need to pass the Grafana's dynamic time range in the url. As per the ",(0,n.jsx)(e.a,{href:"https://community.thingspeak.com/documentation%20.../api/",children:"ThingSpeak API specification"}),", you need to pass the start and end time to the url as query string params. To do that, I am appending ",(0,n.jsx)(e.code,{children:"?start=${__from:date:YYYY-MM-DD HH:NN:SS}&end=${__to:date:YYYY-MM-DD HH:NN:SS}"})," to the url. You can use any variable as specified in the ",(0,n.jsx)(e.a,{href:"https://grafana.com/docs/grafana/latest/variables/variable-types/global-variables/",children:"grafana doc"})]}),`
`,(0,n.jsxs)(e.p,{children:["My full url now becomes ",(0,n.jsx)(e.code,{children:"https://thingspeak.com/channels/38629/feed.json?start=${__from:date:YYYY-MM-DD HH:NN:SS}&end=${__to:date:YYYY-MM-DD HH:NN:SS}"}),"."]}),`
`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:"https://user-images.githubusercontent.com/153843/108482298-392ce500-7291-11eb-9137-888fc4b3515b.png#center#center",alt:"image"})}),`
`,(0,n.jsxs)(e.h2,{id:"long-time-range",children:[(0,n.jsx)(e.a,{className:"anchor",href:"#long-time-range",children:(0,n.jsx)(e.span,{className:"icon icon-link"})}),"Long time range"]}),`
`,(0,n.jsxs)(e.p,{children:["Typically for up to 2 hour you can get all the metrics without any aggregation. If you are looking for more long time range, you may need to pass aggregation filter to your url. Here in the below example, I am looking for data worth of recent 180days. So i am pulling the aggregated data using the url ",(0,n.jsx)(e.code,{children:"https://thingspeak.com/channels/38629/feed.json?start=${__from:date:YYYY-MM-DD HH:NN:SS}&end=${__to:date:YYYY-MM-DD HH:NN:SS}&average=1440"})," the key to look at here is ",(0,n.jsx)(e.strong,{children:"average=1440"})," where it specify to take average of each 1440 minutes/1day. You can specify more granular time aggregation. As per the document, 10, 15, 20, 30, 60, 240, 720, 1440 are the valid time range in minutes. Also instead average you can use sum/timescale/median functions."]}),`
`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:"https://user-images.githubusercontent.com/153843/108484741-0cc69800-7294-11eb-956b-8dfb74123301.png#center",alt:"image"})}),`
`,(0,n.jsxs)(e.h2,{id:"note",children:[(0,n.jsx)(e.a,{className:"anchor",href:"#note",children:(0,n.jsx)(e.span,{className:"icon icon-link"})}),"Note"]}),`
`,(0,n.jsxs)(e.blockquote,{children:[`
`,(0,n.jsxs)(e.p,{children:["This post was originally posted in ",(0,n.jsx)(e.a,{href:"https://github.com/grafana/grafana-infinity-datasource/discussions/38",children:"github discussion"})]}),`
`]})]})}function S(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,Object.assign({},a,{children:(0,n.jsx)(h,a)})):h(a)}var Y=S;return N(x);})();
;return Component;9:["$","article",null,{"className":"py-1 prose dark:prose-invert","children":["$undefined",["$","header",null,{"children":[["$","h1",null,{"className":"mb-2 font-extrabold text-2xl","children":"Thingspeak API"}],"$undefined",["$","p",null,{"className":"space-x-1 text-xs text-gray-500"}]]}],["$","hr",null,{"className":"my-6"}],["$","div",null,{"className":"markdown-content","children":["$","$La",null,{"code":"$b"}]}]]}]
8:null
